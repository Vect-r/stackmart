{% extends 'dashboard/base.html' %}
{% load static %}
{% load markdown_extras %} {# Ensure you have this tag library loaded #}

{% block title %}{{ blog.title }} | Stackmart Logs{% endblock %}

{% block content %}
<div class="min-h-screen relative pb-20">
    
    <div class="fixed top-20 right-0 w-[500px] h-[500px] bg-brand-purple/5 rounded-full blur-[100px] -z-10 pointer-events-none"></div>
    <div class="fixed bottom-0 left-0 w-[500px] h-[500px] bg-brand-cyan/5 rounded-full blur-[100px] -z-10 pointer-events-none"></div>

    <div class="w-full bg-[#09090b] border-b border-gray-800 pt-24 pb-12 px-4 relative overflow-hidden">
        
        <div class="absolute inset-0 opacity-10" 
             style="background-image: linear-gradient(#3f3f46 1px, transparent 1px), linear-gradient(to right, #3f3f46 1px, transparent 1px); background-size: 40px 40px;">
        </div>

        <div class="max-w-4xl mx-auto relative z-10">
            <div class="flex items-center gap-2 text-xs font-mono text-gray-500 mb-6">
                <a href="{% url 'blog' %}" class="hover:text-brand-cyan transition-colors">/var/log</a>
                <span>/</span>
                <span class="text-brand-purple">{{ blog.category.slug }}</span>
                <span>/</span>
                <span class="text-gray-300 truncate max-w-[200px]">{{ blog.slug }}</span>
            </div>

            <h1 class="text-3xl md:text-5xl font-extrabold text-white font-mono tracking-tight leading-tight mb-6">
                {{ blog.title }}
            </h1>

            <div class="flex flex-wrap items-center gap-4 md:gap-8 text-sm font-mono text-gray-400">
                
                <div class="flex items-center gap-2">
                    <img src="{{ blog.author.profile.url }}" class="w-6 h-6 rounded-full border border-gray-700">
                    <span class="text-gray-300">@{{ blog.author.username }}</span>
                </div>

                <div class="flex items-center gap-2">
                    <i class="fa-regular fa-calendar text-brand-cyan"></i>
                    <span>{{ blog.created_at|date:"M d, Y" }}</span>
                </div>

                <div class="flex items-center gap-2">
                    <i class="fa-regular fa-clock text-brand-pink"></i>
                    <span>{{ blog.read_time }} min read</span>
                </div>

                {% if request.authenticated_user == blog.author %}
                <a href="{% url 'blogEdit' blog.id %}" class="ml-auto px-3 py-1 rounded border border-gray-700 hover:border-brand-purple hover:text-brand-purple transition-all text-xs">
                    <i class="fa-solid fa-pen-to-square mr-1"></i> Edit_Log
                </a>
                {% endif %}
            </div>
        </div>
    </div>

    <article class="max-w-4xl mx-auto px-4 mt-10">
    
    {% if blog.cover_image %}
    <div class="rounded-2xl overflow-hidden border border-gray-800 shadow-2xl mb-12 group">
        <div class="relative">
            <div class="absolute inset-0 bg-gradient-to-t from-[#09090b] to-transparent opacity-60"></div>
            <img src="{{ blog.cover_image.url }}" alt="{{ blog.title }}" class="w-full h-auto max-h-[500px] object-cover">
        </div>
    </div>
    {% endif %}

    <div class="markdown-body text-gray-300 font-sans leading-relaxed space-y-6">
        {{ blog.body|markdown|safe }}
    </div>

</article>

</div>
<style>
    /* Headers */
    .markdown-body h1, .markdown-body h2, .markdown-body h3 {
        color: white;
        font-family: 'Fira Code', monospace;
        font-weight: 700;
        margin-top: 2.5rem;
        margin-bottom: 1rem;
    }
    .markdown-body h1 { font-size: 2.25rem; line-height: 2.5rem; }
    .markdown-body h2 { font-size: 1.875rem; line-height: 2.25rem; border-bottom: 1px solid #27272a; padding-bottom: 0.5rem; }
    .markdown-body h3 { font-size: 1.5rem; line-height: 2rem; }

    /* Text */
    .markdown-body p { margin-bottom: 1.5rem; line-height: 1.8; color: #d4d4d8; }
    .markdown-body strong { color: white; font-weight: 700; }
    .markdown-body em { color: #a1a1aa; font-style: italic; }
    .markdown-body del { text-decoration: line-through; opacity: 0.7; }

    /* Lists */
    .markdown-body ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1.5rem; }
    .markdown-body ol { list-style-type: decimal; padding-left: 1.5rem; margin-bottom: 1.5rem; }
    .markdown-body li { margin-bottom: 0.5rem; color: #d4d4d8; }
    .markdown-body li::marker { color: #00dfd8; /* brand-cyan */ }

    /* Links */
    .markdown-body a { color: #00dfd8; text-decoration: none; border-bottom: 1px solid transparent; transition: all 0.2s; }
    .markdown-body a:hover { color: #ff0080; border-bottom-color: #ff0080; }

    /* Code Blocks */
    .markdown-body pre {
        background-color: #131316;
        border: 1px solid #27272a;
        border-radius: 0.75rem;
        padding: 1.5rem;
        overflow-x: auto;
        margin-bottom: 2rem;
        font-family: 'Fira Code', monospace;
        position: relative;
    }
    /* Terminal Dots Decoration */
    .markdown-body pre::before {
        content: "";
        display: block;
        width: 10px; height: 10px;
        background: #ef4444;
        border-radius: 50%;
        box-shadow: 20px 0 0 #eab308, 40px 0 0 #22c55e;
        margin-bottom: 1.5rem;
        opacity: 0.5;
    }
    
    /* Inline Code */
    .markdown-body code {
        background-color: rgba(121, 40, 202, 0.15); /* brand-purple/15 */
        color: #e879f9; /* light purple */
        padding: 0.2rem 0.4rem;
        border-radius: 0.375rem;
        font-family: 'Fira Code', monospace;
        font-size: 0.875em;
    }
    .markdown-body pre code {
        background-color: transparent;
        color: inherit;
        padding: 0;
        font-size: 0.9em;
    }

    /* Images */
    .markdown-body img {
        border-radius: 0.75rem;
        border: 1px solid #27272a;
        margin: 2rem 0;
        box-shadow: 0 10px 30px -10px rgba(0,0,0,0.5);
    }

    /* Blockquotes */
    .markdown-body blockquote {
        border-left: 4px solid #7928ca; /* brand-purple */
        background: rgba(121, 40, 202, 0.05);
        padding: 1rem 1.5rem;
        border-radius: 0 0.5rem 0.5rem 0;
        margin-bottom: 1.5rem;
        font-style: italic;
        color: #e4e4e7;
    }
</style>
{% endblock %}